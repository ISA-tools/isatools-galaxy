language: python

before_install:
 - export GALAXY_REPO=${TRAVIS_BUILD_DIR}/galaxy
 - export PLANEMO_RELEASE=0.54.0

install:
 - sudo apt-get install -y python-virtualenv
 - virtualenv planemo-venv
 - . planemo-venv/bin/activate
 - pip install --upgrade pip setuptools
 - pip install planemo==$PLANEMO_RELEASE
 - git clone -b feature/isa_data_type_plus_enhancements https://github.com/phnmnl/galaxy ${GALAXY_REPO}

script:
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/converters/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/isacreate/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/isaslicer/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/isaslicer2/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/mtbls/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/other/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/validators/
 - planemo lint ${TRAVIS_BUILD_DIR}/tools/visualizations/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/converters/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/isacreate/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/isaslicer/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/isaslicer2/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/mtbls/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/other/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/validators/
 - planemo test --galaxy_root=${GALAXY_REPO} --tool_data_table=${TRAVIS_BUILD_DIR}/config/tool_data_table_conf.xml ${TRAVIS_BUILD_DIR}/tools/visualizations/


branches:
  only:
  - master
  - develop
